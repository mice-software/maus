//Test of basic phasing of RF cavities
//Check that the RF cavity is phased correctly

Configuration PhaseTest
{
  ERROR THIS GEOMETRY DOES NOT WORK - I HAVENT FIGURED OUT SINGLE PARTICLE TRANSPORT IN MAUS YET

  Dimensions 1.0 1.0 600 m
  PropertyString Material  Galactic
  PropertyDouble G4StepMax 100 mm

  Module Envelope
  {
    Volume None
    Position 0.0 0.0 75.0+37.5 cm
    PropertyString SensitiveDetector   Envelope
    PropertyString IndependentVariable Z
    PropertyBool   PolyFitDetector     true
  } 
  Module Beam
  {
    Position       0.0 0.0 -37.5 cm
    Volume None
    PropertyString EnvelopeType    PolyFit
    PropertyString BeamType       Gaussian
    PropertyInt    PolynomialOrder 2
    PropertyDouble Tolerance       1.e-8
    PropertyInt    Pid             -13
    PropertyString LongitudinalVariable Momentum
    PropertyDouble Momentum        200.
    PropertyDouble Time            0.
    PropertyBool   UseAsReference  true

    PropertyString EllipseDefinition Penn
    PropertyDouble Emittance_T    10.0 mm
    PropertyDouble Emittance_L    0.01 ns
    PropertyDouble Beta_T         650. mm
    PropertyDouble Beta_L         5.   ns
    PropertyDouble Alpha_T        0.
    PropertyDouble Alpha_L        0.
    PropertyDouble NormalisedAngularMomentum 0.
    PropertyDouble Bz             0. T

    PropertyString RootOutput      envelope-polyfit.root
    PropertyString LongTextOutput  envelope-polyfit.txt

    PropertyDouble Delta_t        1 ns
    PropertyDouble Delta_E        1 MeV
    PropertyDouble Delta_x        1 mm
    PropertyDouble Delta_Px       1 MeV
    PropertyDouble Delta_y        1 mm
    PropertyDouble Delta_Py       1 MeV

    PropertyDouble Delta_t_Max    3. ns
  }

  Module Virtual
  {
    Volume None
    Position 0.0 0.0 -37.5+37.50*@RepeatNumber cm
    PropertyString SensitiveDetector   Virtual
    PropertyString IndependentVariable Z
    PropertyBool   RepeatModule2  true
    PropertyInt    NumberOfRepeats 6
  }
  Module Coil
  {
    Volume None
    Position 0.0 0.0 -525.0+75.0*@RepeatNumber cm
    PropertyString FieldType      Solenoid
    PropertyString FileName       fs2a_coil.fld
    PropertyString FieldMapMode   Write
    PropertyDouble CurrentDensity 1.
    PropertyDouble Length         150.
    PropertyDouble Thickness      150.
    PropertyDouble InnerRadius    350.
    PropertyDouble ScaleFactor    106.66*(-1.)**@RepeatNumber
    PropertyBool   RepeatModule2  true
    PropertyInt    NumberOfRepeats 20
  } 
}

