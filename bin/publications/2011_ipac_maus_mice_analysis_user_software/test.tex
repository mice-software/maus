
\documentclass{article}
\usepackage{fancyvrb}
\usepackage{color}
\usepackage[ascii]{inputenc}



\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\def\PY@tok@gd{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\def\PY@tok@gu{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\def\PY@tok@gt{\def\PY@tc##1{\textcolor[rgb]{0.00,0.25,0.82}{##1}}}
\def\PY@tok@gs{\let\PY@bf=\textbf}
\def\PY@tok@gr{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\def\PY@tok@cm{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\def\PY@tok@vg{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\def\PY@tok@m{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\def\PY@tok@mh{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\def\PY@tok@go{\def\PY@tc##1{\textcolor[rgb]{0.50,0.50,0.50}{##1}}}
\def\PY@tok@ge{\let\PY@it=\textit}
\def\PY@tok@vc{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\def\PY@tok@il{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\def\PY@tok@cs{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\def\PY@tok@cp{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\def\PY@tok@gi{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\def\PY@tok@gh{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\def\PY@tok@ni{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\def\PY@tok@nl{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\def\PY@tok@nn{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\def\PY@tok@no{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\def\PY@tok@na{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\def\PY@tok@nb{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\def\PY@tok@nc{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\def\PY@tok@nd{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\def\PY@tok@ne{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\def\PY@tok@nf{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\def\PY@tok@si{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\def\PY@tok@s2{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\def\PY@tok@vi{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\def\PY@tok@nt{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\def\PY@tok@nv{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\def\PY@tok@s1{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\def\PY@tok@sh{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\def\PY@tok@sc{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\def\PY@tok@sx{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\def\PY@tok@bp{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\def\PY@tok@c1{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\def\PY@tok@kc{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\def\PY@tok@c{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\def\PY@tok@mf{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\def\PY@tok@err{\def\PY@bc##1{\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{##1}}}
\def\PY@tok@kd{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\def\PY@tok@ss{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\def\PY@tok@sr{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\def\PY@tok@mo{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\def\PY@tok@kn{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\def\PY@tok@mi{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\def\PY@tok@gp{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\def\PY@tok@o{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\def\PY@tok@kr{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\def\PY@tok@s{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\def\PY@tok@kp{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\def\PY@tok@w{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\def\PY@tok@kt{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\def\PY@tok@ow{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\def\PY@tok@sb{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\def\PY@tok@k{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\def\PY@tok@se{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\def\PY@tok@sd{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


\begin{document}

\section*{}

\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+cp}{\PYZsh{}}\PY{c+cp}{!}\PY{c+cp}{/}\PY{c+cp}{usr}\PY{c+cp}{/}\PY{c+cp}{bin}\PY{c+cp}{/}\PY{c+cp}{env python}

\PY{c+cp}{\PYZsh{}}\PY{c+cp}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
\PY{c+cp}{\PYZsh{}}\PY{c+cp}{\PYZsh{}\PYZsh{}!!! YOU ARE NOT ALLOWED TO MODIFY THIS FILE DIRECTLY    !!!\PYZsh{}\PYZsh{}\PYZsh{}}
\PY{c+cp}{\PYZsh{}}\PY{c+cp}{\PYZsh{}\PYZsh{}!!! PLEASE MAKE A COPY OF THIS FILE WITH THE CP COMMAND !!!\PYZsh{}\PYZsh{}\PYZsh{}}
\PY{c+cp}{\PYZsh{}}\PY{c+cp}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}

\PY{l+s}{"}\PY{l+s}{"}\PY{l+s}{"}\PY{l+s}{Simulate the MICE experiment}

\PY{n}{This} \PY{n}{will} \PY{n}{simulate} \PY{err}{'}\PY{n}{number\PYZus{}of\PYZus{}spills}\PY{err}{'} \PY{n}{MICE} \PY{n}{events} \PY{n}{through} \PY{n}{the} \PY{n}{entirity}
\PY{n}{of} \PY{n}{MICE} \PY{n}{using} \PY{n}{Geant4}\PY{p}{.}  \PY{n}{At} \PY{n}{present}\PY{p}{,} \PY{n}{TOF} \PY{n}{and} \PY{n}{Tracker} \PY{n}{hits} \PY{n}{will} \PY{n}{be} \PY{n}{digitized}\PY{p}{.}
\PY{l+s}{"}\PY{l+s}{"}\PY{l+s}{"}

\PY{n}{import} \PY{n}{io}   \PY{err}{\PYZsh{}}  \PY{n}{generic} \PY{n}{python} \PY{n}{library} \PY{k}{for} \PY{n}{I}\PY{o}{/}\PY{n}{O}
\PY{n}{import} \PY{n}{gzip} \PY{err}{\PYZsh{}}  \PY{n}{For} \PY{n}{compressed} \PY{n}{output} \PY{err}{\PYZsh{}} \PY{n}{pylint}\PY{o}{:} \PY{n}{disable}\PY{o}{=}\PY{n}{W0611}

\PY{n}{import} \PY{n}{MAUS}

\PY{n}{def} \PY{n}{run}\PY{p}{(}\PY{n}{number\PYZus{}of\PYZus{}spills}\PY{p}{)}\PY{o}{:}
    \PY{l+s}{"}\PY{l+s}{"}\PY{l+s}{"}\PY{l+s}{ Run the macro}
    \PY{l+s}{"}\PY{l+s}{"}\PY{l+s}{"}

\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{ Here we create a pseudo-file with an event in it.  If you were to copy}
\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{ and paste this to a file, then you could also do:}
\PY{c+cp}{    \PYZsh{}}
\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{   input\PYZus{}file = open('myFileName.txt', 'r')}
\PY{c+cp}{    \PYZsh{}}
\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{ where the file format has a JSON document per line.  I just toss the file}
\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{ in here for simplicity.}
    \PY{n}{input\PYZus{}file} \PY{o}{=} \PY{n}{io}\PY{p}{.}\PY{n}{StringIO}\PY{p}{(}\PY{n}{number\PYZus{}of\PYZus{}spills}\PY{o}{*}\PY{n}{u}\PY{l+s}{"}\PY{l+s}{"}\PY{l+s}{"}\PY{l+s}{\PYZob{}}\PY{l+s}{"}\PY{n}{mc}\PY{l+s}{"}\PY{l+s}{: [\PYZob{}}\PY{l+s}{"}\PY{n}{primary}\PY{l+s}{"}\PY{l+s}{:\PYZob{}}\PY{l+s}{"}\PY{n}{position}\PY{l+s}{"}\PY{l+s}{: \PYZob{} }\PY{l+s}{"}\PY{n}{x}\PY{l+s}{"}\PY{l+s}{: 0.0, }\PY{l+s}{"}\PY{n}{y}\PY{l+s}{"}\PY{l+s}{: -0.0, }\PY{l+s}{"}\PY{n}{z}\PY{l+s}{"}\PY{l+s}{: -5000.0 \PYZcb{},}\PY{l+s}{"}\PY{n}{particle\PYZus{}id}\PY{l+s}{"}\PY{l+s}{ : 13,}\PY{l+s}{"}\PY{n}{energy}\PY{l+s}{"}\PY{l+s}{ : 210.0, }\PY{l+s}{"}\PY{n}{random\PYZus{}seed}\PY{l+s}{"}\PY{l+s}{ : 10, }\PY{l+s}{"}\PY{n}{momentum}\PY{l+s}{"}\PY{l+s}{ : \PYZob{} }\PY{l+s}{"}\PY{n}{x}\PY{l+s}{"}\PY{l+s}{:0.0, }\PY{l+s}{"}\PY{n}{y}\PY{l+s}{"}\PY{l+s}{:0.0, }\PY{l+s}{"}\PY{n}{z}\PY{l+s}{"}\PY{l+s}{:1.0 \PYZcb{}, }\PY{l+s}{"}\PY{n}{time}\PY{l+s}{"}\PY{l+s}{ : 0.0\PYZcb{}\PYZcb{}]\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s}{"}\PY{l+s}{"}\PY{l+s}{"}\PY{p}{)} \PY{err}{\PYZsh{}} \PY{n}{pylint}\PY{o}{:} \PY{n}{disable}\PY{o}{=}\PY{n}{C0301}  

    \PY{n}{my\PYZus{}input} \PY{o}{=} \PY{n}{MAUS}\PY{p}{.}\PY{n}{InputPyJSON}\PY{p}{(}\PY{n}{input\PYZus{}file}\PY{p}{)}

\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{ Create an empty array of mappers, then populate it}
\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{ with the functionality you want to use.}
    \PY{n}{my\PYZus{}map} \PY{o}{=} \PY{n}{MAUS}\PY{p}{.}\PY{n}{MapPyGroup}\PY{p}{(}\PY{p}{)}
    \PY{n}{my\PYZus{}map}\PY{p}{.}\PY{n}{append}\PY{p}{(}\PY{n}{MAUS}\PY{p}{.}\PY{n}{MapCppSimulation}\PY{p}{(}\PY{p}{)}\PY{p}{)}  \PY{err}{\PYZsh{}}  \PY{n}{geant4} \PY{n}{simulation}
    \PY{n}{my\PYZus{}map}\PY{p}{.}\PY{n}{append}\PY{p}{(}\PY{n}{MAUS}\PY{p}{.}\PY{n}{MapCppTOFDigitization}\PY{p}{(}\PY{p}{)}\PY{p}{)}  \PY{err}{\PYZsh{}}  \PY{n}{TOF} \PY{n}{electronics} \PY{n}{model}
    \PY{n}{my\PYZus{}map}\PY{p}{.}\PY{n}{append}\PY{p}{(}\PY{n}{MAUS}\PY{p}{.}\PY{n}{MapCppTrackerDigitization}\PY{p}{(}\PY{p}{)}\PY{p}{)}  \PY{err}{\PYZsh{}}   \PY{n}{SCiFi} \PY{n}{electronics} \PY{n}{model}

    \PY{n}{datacards} \PY{o}{=} \PY{n}{io}\PY{p}{.}\PY{n}{StringIO}\PY{p}{(}\PY{n}{u}\PY{l+s}{"}\PY{l+s}{keep\PYZus{}tracks = False}\PY{l+s}{"}\PY{p}{)}
\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{  You may specify datacards if you wish.  To do so you create a file object}
\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{  which can either be a StringIO object or a native python file.  If you}
\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{  want to store your datacards in a file 'datacards.dat' then uncomment:}
\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{ datacards = open('datacards.dat', 'r')}


\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{  Choose from either a compressed or uncompressed output file}
\PY{c+cp}{    \PYZsh{}}
    \PY{n}{output\PYZus{}file} \PY{o}{=} \PY{n}{open}\PY{p}{(}\PY{l+s}{"}\PY{l+s}{simulation.out}\PY{l+s}{"}\PY{p}{,} \PY{l+s+sc}{'w'}\PY{p}{)}  \PY{err}{\PYZsh{}}  \PY{n}{Uncompressed}
\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{output\PYZus{}file = gzip.GzipFile("mausput.gz", 'wb')  \PYZsh{}  Compressed}

\PY{c+cp}{    \PYZsh{}}
\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{ Then construct a MAUS output component}
    \PY{n}{my\PYZus{}output} \PY{o}{=} \PY{n}{MAUS}\PY{p}{.}\PY{n}{OutputPyJSON}\PY{p}{(}\PY{n}{output\PYZus{}file}\PY{p}{)}

\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{  The Go() drives all the components you pass in, then check the file}
\PY{c+cp}{    \PYZsh{}}\PY{c+cp}{  'mausput' for the output}

    \PY{n}{MAUS}\PY{p}{.}\PY{n}{Go}\PY{p}{(}\PY{n}{my\PYZus{}input}\PY{p}{,} \PY{n}{my\PYZus{}map}\PY{p}{,} \PY{n}{MAUS}\PY{p}{.}\PY{n}{ReducePyDoNothing}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{my\PYZus{}output}\PY{p}{,} \PY{n}{datacards}\PY{p}{)}


\PY{k}{if} \PY{n}{\PYZus{}\PYZus{}name\PYZus{}\PYZus{}} \PY{o}{=}\PY{o}{=} \PY{err}{'}\PY{n}{\PYZus{}\PYZus{}main\PYZus{}\PYZus{}}\PY{err}{'}\PY{o}{:}
    \PY{n}{NUMBER\PYZus{}OF\PYZus{}SPILLS} \PY{o}{=} \PY{l+m+mi}{2000}
    \PY{n}{run}\PY{p}{(}\PY{n}{NUMBER\PYZus{}OF\PYZus{}SPILLS}\PY{p}{)}
\end{Verbatim}

\end{document}
